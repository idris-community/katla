1/1: Building Rainbow (Rainbow.idr)
\documentclass{article}

\usepackage{inconsolata}

\usepackage{fancyvrb}
\usepackage[x11names]{xcolor}
\newcommand{\Katla}                [2][]{\VerbatimInput[commandchars=\\\{\}#1]{#2}}
\newcommand{\KatlaSpace}              { }
\newcommand{\IdrisHlightFont}         {\ttfamily}
\newcommand{\IdrisHlightStyleData}    {}
\newcommand{\IdrisHlightStyleType}    {}
\newcommand{\IdrisHlightStyleBound}   {}
\newcommand{\IdrisHlightStyleFunction}{}
\newcommand{\IdrisHlightStyleKeyword} {\bfseries}
\newcommand{\IdrisHlightStyleImplicit}{}
\newcommand{\IdrisHlightStyleComment} {\itshape}
\newcommand{\IdrisHlightStyleHole}    {\bfseries}
\newcommand{\IdrisHlightStyleNamespace}{\itshape}
\newcommand{\IdrisHlightStylePostulate}{\bfseries}
\newcommand{\IdrisHlightStyleModule}   {\itshape}

\newcommand{\IdrisHlightColourData}    {IndianRed1}
\newcommand{\IdrisHlightColourType}    {DeepSkyBlue3}
\newcommand{\IdrisHlightColourBound}   {DarkOrchid3}
\newcommand{\IdrisHlightColourFunction}{Chartreuse4}
\newcommand{\IdrisHlightColourKeyword} {black}
\newcommand{\IdrisHlightColourImplicit}{DarkOrchid3}
\newcommand{\IdrisHlightColourComment} {grey}
\newcommand{\IdrisHlightColourHole}    {yellow}
\newcommand{\IdrisHlightColourNamespace}{black}
\newcommand{\IdrisHlightColourPostulate}{DarkOrchid3}
\newcommand{\IdrisHlightColourModule}   {black}

\newcommand{\IdrisHole}[1]{{%
    \colorbox{\IdrisHlightColourHole}{%
      \IdrisHlightStyleHole\IdrisHlightFont%
      #1}}}

\newcommand{\RawIdrisHighlight}[3]{{\textcolor{#1}{\IdrisHlightFont#2{#3}}}}

\newcommand{\IdrisData}[1]{\RawIdrisHighlight{\IdrisHlightColourData}{\IdrisHlightStyleData}{#1}}
\newcommand{\IdrisType}[1]{\RawIdrisHighlight{\IdrisHlightColourType}{\IdrisHlightStyleType}{#1}}
\newcommand{\IdrisBound}[1]{\RawIdrisHighlight{\IdrisHlightColourBound}{\IdrisHlightStyleBound}{#1}}
\newcommand{\IdrisFunction}[1]{\RawIdrisHighlight{\IdrisHlightColourFunction}{\IdrisHlightStyleFunction}{#1}}
\newcommand{\IdrisKeyword}[1]{\RawIdrisHighlight{\IdrisHlightColourKeyword}{\IdrisHlightStyleKeyword}{#1}}
\newcommand{\IdrisImplicit}[1]{\RawIdrisHighlight{\IdrisHlightColourImplicit}{\IdrisHlightStyleImplicit}{#1}}
\newcommand{\IdrisComment}[1]{\RawIdrisHighlight{\IdrisHlightColourComment}{\IdrisHlightStyleComment}{#1}}
\newcommand{\IdrisNamespace}[1]{\RawIdrisHighlight{\IdrisHlightColourNamespace}{\IdrisHlightStyleNamespace}{#1}}
\newcommand{\IdrisPostulate}[1]{\RawIdrisHighlight{\IdrisHlightColourPostulate}{\IdrisHlightStylePostulate}{#1}}
\newcommand{\IdrisModule}[1]{\RawIdrisHighlight{\IdrisHlightColourModule}{\IdrisHlightStyleModule}{#1}}

% Bugfix in fancyvrb to allow inline saved listings
\makeatletter
\let\FV@ProcessLine\relax
\makeatother


\begin{document}
\begin{Verbatim}[commandchars=\\\{\}]
\IdrisKeyword{namespace}\KatlaSpace{}\IdrisNamespace{L0}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{public}\KatlaSpace{}\IdrisKeyword{export}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{data}\KatlaSpace{}\IdrisType{List0}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Type}


\IdrisKeyword{namespace}\KatlaSpace{}\IdrisNamespace{L1}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{public}\KatlaSpace{}\IdrisKeyword{export}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{data}\KatlaSpace{}\IdrisType{List1}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Type}\KatlaSpace{}\IdrisKeyword{where}
\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\IdrisData{Nil}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{List1}
\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\IdrisData{Cons1}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List0}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List1}

\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{public}\KatlaSpace{}\IdrisKeyword{export}
\KatlaSpace{}\KatlaSpace{}\IdrisFunction{(::)}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List0}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List1}
\KatlaSpace{}\KatlaSpace{}\IdrisFunction{(::)}\KatlaSpace{}\IdrisKeyword{=}\KatlaSpace{}\IdrisData{Cons1}

\IdrisKeyword{namespace}\KatlaSpace{}\IdrisNamespace{L2}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{public}\KatlaSpace{}\IdrisKeyword{export}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{data}\KatlaSpace{}\IdrisType{(::)}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List0}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{Type}\KatlaSpace{}\IdrisKeyword{where}

\IdrisKeyword{namespace}\KatlaSpace{}\IdrisNamespace{L0}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{public}\KatlaSpace{}\IdrisKeyword{export}
\KatlaSpace{}\KatlaSpace{}\IdrisKeyword{data}\KatlaSpace{}\IdrisType{List0}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Type}\KatlaSpace{}\IdrisKeyword{where}
\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\IdrisData{Nil}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{List0}
\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\KatlaSpace{}\IdrisData{(::)}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}\KatlaSpace{}\IdrisKeyword{->}\IdrisType{Type}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{List0}

\IdrisFunction{m}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}
\IdrisFunction{m}\KatlaSpace{}\IdrisKeyword{=}\KatlaSpace{}\IdrisPostulate{believe_me}\KatlaSpace{}\IdrisData{%MkWorld}

\IdrisFunction{Rainbow}\KatlaSpace{}\IdrisKeyword{:}\KatlaSpace{}\IdrisType{Nat}\KatlaSpace{}\IdrisKeyword{->}\KatlaSpace{}\IdrisType{Type}
\IdrisFunction{Rainbow}\KatlaSpace{}\IdrisBound{n}\KatlaSpace{}\IdrisKeyword{=}\KatlaSpace{}\KatlaSpace{}\IdrisType{[}\KatlaSpace{}\IdrisBound{n}\KatlaSpace{}\IdrisData{,}\KatlaSpace{}\IdrisFunction{m}\KatlaSpace{}\IdrisType{,}\KatlaSpace{}\IdrisBound{n}\KatlaSpace{}\IdrisData{]}

\end{Verbatim}
\end{document}
Expected: directly writing to file gives the same results
ata</span>&nbsp;<span class="IdrisType">(::)</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">where</span><br />
< <a href="#line18" id="line18" class="IdrisLineNumber"> 18 | </a><br />
< <a href="#line19" id="line19" class="IdrisLineNumber"> 19 | </a>namespace&nbsp;<span class="IdrisNamespace">L0</span><br />
< <a href="#line20" id="line20" class="IdrisLineNumber"> 20 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span><br />
< <a href="#line21" id="line21" class="IdrisLineNumber"> 21 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">data</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">where</span><br />
< <a href="#line22" id="line22" class="IdrisLineNumber"> 22 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">Nil</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">List0</span><br />
< <a href="#line23" id="line23" class="IdrisLineNumber"> 23 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">(::)</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span><span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span><br />
< <a href="#line24" id="line24" class="IdrisLineNumber"> 24 | </a><br />
< <a href="#line25" id="line25" class="IdrisLineNumber"> 25 | </a><span class="IdrisFunction">m</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span><br />
< <a href="#line26" id="line26" class="IdrisLineNumber"> 26 | </a><span class="IdrisFunction">m</span>&nbsp;<span class="IdrisKeyword">=</span>&nbsp;<span class="IdrisPostulate">believe_me</span>&nbsp;<span class="IdrisData">%MkWorld</span><br />
< <a href="#line27" id="line27" class="IdrisLineNumber"> 27 | </a><br />
< <a href="#line28" id="line28" class="IdrisLineNumber"> 28 | </a><span class="IdrisFunction">Rainbow</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">Type</span><br />
< <a href="#line29" id="line29" class="IdrisLineNumber"> 29 | </a><span class="IdrisFunction">Rainbow</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisKeyword">=</span>&nbsp;&nbsp;<span class="IdrisType">[</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisData">,</span>&nbsp;<span class="IdrisFunction">m</span>&nbsp;<span class="IdrisType">,</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisData">]</span><br />
< <a href="#line30" id="line30" class="IdrisLineNumber"> 30 | </a><br />
---
> <div id="line0"><a href="#line0" class="IdrisLineNumber"> &nbsp;0 | </a><span class="IdrisKeyword">namespace</span>&nbsp;<span class="IdrisNamespace">L0</span></div>
> <div id="line1"><a href="#line1" class="IdrisLineNumber"> &nbsp;1 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span></div>
> <div id="line2"><a href="#line2" class="IdrisLineNumber"> &nbsp;2 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">data</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Type</span></div>
> <div id="line3"><a href="#line3" class="IdrisLineNumber"> &nbsp;3 | </a></div>
> <div id="line4"><a href="#line4" class="IdrisLineNumber"> &nbsp;4 | </a></div>
> <div id="line5"><a href="#line5" class="IdrisLineNumber"> &nbsp;5 | </a><span class="IdrisKeyword">namespace</span>&nbsp;<span class="IdrisNamespace">L1</span></div>
> <div id="line6"><a href="#line6" class="IdrisLineNumber"> &nbsp;6 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span></div>
> <div id="line7"><a href="#line7" class="IdrisLineNumber"> &nbsp;7 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">data</span>&nbsp;<span class="IdrisType">List1</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">where</span></div>
> <div id="line8"><a href="#line8" class="IdrisLineNumber"> &nbsp;8 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">Nil</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">List1</span></div>
> <div id="line9"><a href="#line9" class="IdrisLineNumber"> &nbsp;9 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">Cons1</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List1</span></div>
> <div id="line10"><a href="#line10" class="IdrisLineNumber"> 10 | </a></div>
> <div id="line11"><a href="#line11" class="IdrisLineNumber"> 11 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span></div>
> <div id="line12"><a href="#line12" class="IdrisLineNumber"> 12 | </a>&nbsp;&nbsp;<span class="IdrisFunction">(::)</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List1</span></div>
> <div id="line13"><a href="#line13" class="IdrisLineNumber"> 13 | </a>&nbsp;&nbsp;<span class="IdrisFunction">(::)</span>&nbsp;<span class="IdrisKeyword">=</span>&nbsp;<span class="IdrisData">Cons1</span></div>
> <div id="line14"><a href="#line14" class="IdrisLineNumber"> 14 | </a></div>
> <div id="line15"><a href="#line15" class="IdrisLineNumber"> 15 | </a><span class="IdrisKeyword">namespace</span>&nbsp;<span class="IdrisNamespace">L2</span></div>
> <div id="line16"><a href="#line16" class="IdrisLineNumber"> 16 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span></div>
> <div id="line17"><a href="#line17" class="IdrisLineNumber"> 17 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">data</span>&nbsp;<span class="IdrisType">(::)</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">where</span></div>
> <div id="line18"><a href="#line18" class="IdrisLineNumber"> 18 | </a></div>
> <div id="line19"><a href="#line19" class="IdrisLineNumber"> 19 | </a><span class="IdrisKeyword">namespace</span>&nbsp;<span class="IdrisNamespace">L0</span></div>
> <div id="line20"><a href="#line20" class="IdrisLineNumber"> 20 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">public</span>&nbsp;<span class="IdrisKeyword">export</span></div>
> <div id="line21"><a href="#line21" class="IdrisLineNumber"> 21 | </a>&nbsp;&nbsp;<span class="IdrisKeyword">data</span>&nbsp;<span class="IdrisType">List0</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">where</span></div>
> <div id="line22"><a href="#line22" class="IdrisLineNumber"> 22 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">Nil</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">List0</span></div>
> <div id="line23"><a href="#line23" class="IdrisLineNumber"> 23 | </a>&nbsp;&nbsp;&nbsp;&nbsp;<span class="IdrisData">(::)</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span><span class="IdrisType">Type</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">List0</span></div>
> <div id="line24"><a href="#line24" class="IdrisLineNumber"> 24 | </a></div>
> <div id="line25"><a href="#line25" class="IdrisLineNumber"> 25 | </a><span class="IdrisFunction">m</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span></div>
> <div id="line26"><a href="#line26" class="IdrisLineNumber"> 26 | </a><span class="IdrisFunction">m</span>&nbsp;<span class="IdrisKeyword">=</span>&nbsp;<span class="IdrisPostulate">believe_me</span>&nbsp;<span class="IdrisData">%MkWorld</span></div>
> <div id="line27"><a href="#line27" class="IdrisLineNumber"> 27 | </a></div>
> <div id="line28"><a href="#line28" class="IdrisLineNumber"> 28 | </a><span class="IdrisFunction">Rainbow</span>&nbsp;<span class="IdrisKeyword">:</span>&nbsp;<span class="IdrisType">Nat</span>&nbsp;<span class="IdrisKeyword">-&gt;</span>&nbsp;<span class="IdrisType">Type</span></div>
> <div id="line29"><a href="#line29" class="IdrisLineNumber"> 29 | </a><span class="IdrisFunction">Rainbow</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisKeyword">=</span>&nbsp;&nbsp;<span class="IdrisType">[</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisData">,</span>&nbsp;<span class="IdrisFunction">m</span>&nbsp;<span class="IdrisType">,</span>&nbsp;<span class="IdrisBound">n</span>&nbsp;<span class="IdrisData">]</span></div>
> <div id="line30"><a href="#line30" class="IdrisLineNumber"> 30 | </a></div>
